{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@foskym/flarum-pagination/webpack/bootstrap","webpack://@foskym/flarum-pagination/webpack/runtime/compat get default export","webpack://@foskym/flarum-pagination/webpack/runtime/define property getters","webpack://@foskym/flarum-pagination/webpack/runtime/hasOwnProperty shorthand","webpack://@foskym/flarum-pagination/webpack/runtime/make namespace object","webpack://@foskym/flarum-pagination/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/app']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['extend']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/Placeholder']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/Button']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/app']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/extend']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/FieldSet']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@foskym/flarum-pagination/./src/forum/index.js","webpack://@foskym/flarum-pagination/./src/forum/addUserPreference.ts","webpack://@foskym/flarum-pagination/./src/forum/determineMode.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionListItem'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Placeholder'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/FieldSet'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","import app from 'flarum/common/app';\r\nimport { extend, override } from 'flarum/extend';\r\nimport DiscussionList from 'flarum/forum/components/DiscussionList';\r\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\r\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\r\nimport Placeholder from 'flarum/common/components/Placeholder';\r\nimport Button from 'flarum/common/components/Button';\r\nimport Stream from 'flarum/common/utils/Stream';\r\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\r\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\r\n\r\nimport addUserPreference from './addUserPreference';\r\nimport determineMode from './determineMode';\r\n\r\napp.initializers.add('foskym/flarum-pagination', () => {\r\n  addUserPreference();\r\n\r\n  override(DiscussionListState.prototype, 'refresh', function (original, page = 1) {\r\n    this.options = {\r\n      perPage: app.forum.attribute('foskym-pagination.perPage'),\r\n      perLoadMore: app.forum.attribute('foskym-pagination.perLoadMore'),\r\n      perIndexInit: app.forum.attribute('foskym-pagination.perIndexInit'),\r\n      leftEdges: 4,\r\n      rightEdges: 5,\r\n    };\r\n\r\n    this.usePaginationMode = determineMode();\r\n\r\n    if (!this.usePaginationMode) {\r\n      this.pageSize = this.options.perLoadMore;\r\n      return original(page);\r\n    }\r\n\r\n    this.initialLoading = true;\r\n    this.loadingPrev = false;\r\n    this.loadingNext = false;\r\n\r\n    this.clear();\r\n\r\n    this.location = { page };\r\n\r\n    return this.loadPage(page)\r\n      .then((results) => {\r\n        this.pages = [];\r\n        this.parseResults(this.location.page, results);\r\n      })\r\n      .finally(() => (this.initialLoading = false));\r\n  });\r\n\r\n  override(DiscussionListState.prototype, 'loadPage', function (original, page = 1) {\r\n    const reqParams = this.requestParams();\r\n\r\n    const include = Array.isArray(reqParams.include) ? reqParams.include.join(',') : reqParams.include;\r\n\r\n    let newOffset, newLimit;\r\n\r\n    if (this.usePaginationMode) {\r\n      newOffset = this.options.perPage * (page - 1);\r\n      newLimit = this.options.perPage;\r\n    } else {\r\n      newOffset = this.options.perIndexInit * Math.min(page - 1, 1) + this.options.perLoadMore * Math.max(page - 2, 0);\r\n      newLimit = newOffset == 0 ? this.options.perIndexInit : this.options.perLoadMore;\r\n    }\r\n\r\n    const params = {\r\n      ...reqParams,\r\n      page: {\r\n        ...reqParams.page,\r\n        offset: newOffset,\r\n        limit: newLimit,\r\n      },\r\n      include,\r\n    };\r\n\r\n    return app.store.find(this.type, params);\r\n  });\r\n\r\n  override(DiscussionListState.prototype, 'parseResults', function (original, pg, results) {\r\n    if (!this.usePaginationMode) {\r\n      return original(pg, results);\r\n    }\r\n    const pageNum = Number(pg);\r\n\r\n    const links = results.payload?.links || {};\r\n\r\n    const page = {\r\n      number: pageNum,\r\n      items: results,\r\n      hasNext: !!links?.next,\r\n      hasPrev: !!links?.prev,\r\n    };\r\n\r\n    this.hasPage = function (page) {\r\n      let allPages = this.getPages();\r\n      if (allPages.length == 0) return false;\r\n      for (let i = 0; i < allPages.length; i++) {\r\n        if (allPages[i].number == page) return true;\r\n      }\r\n      return false;\r\n    };\r\n\r\n    if (!this.hasPage(pageNum)) {\r\n      this.pages.push(page);\r\n    }\r\n\r\n    this.location = { page: pageNum };\r\n\r\n    this.totalDiscussionCount = Stream(results.payload.jsonapi.totalResultsCount);\r\n    \r\n    this.getTotalPages = function () {\r\n      return Math.ceil(this.totalDiscussionCount() / this.options.perPage);\r\n    };\r\n\r\n    this.page = Stream(page);\r\n    this.perPage = Stream(this.options.perPage);\r\n    this.totalPages = Stream(this.getTotalPages());\r\n\r\n    this.ctrl = {\r\n      prevPage: function () {\r\n        let current = this.page().number;\r\n        --current;\r\n\r\n        if (current < 1) {\r\n          return;\r\n        }\r\n\r\n        this.page(current);\r\n        let next = current;\r\n        this.loadPage(next).then(this.parseResults.bind(this, next));\r\n      }.bind(this),\r\n\r\n      nextPage: function () {\r\n        let current = this.page().number;\r\n        ++current;\r\n\r\n        if (current > this.totalPages()) {\r\n          current = this.totalPages();\r\n          return;\r\n        }\r\n\r\n        this.page(current);\r\n        let next = current;\r\n        this.loadPage(next).then(this.parseResults.bind(this, next));\r\n      }.bind(this),\r\n\r\n      toPage: function (page) {\r\n        if (this.page().number == Number(page) || page < 1 || page > this.totalPages()) return;\r\n\r\n        this.page(Number(page));\r\n        let next = Number(page);\r\n\r\n        this.loadPage(next).then(this.parseResults.bind(this, next)); //.then(this.preLoadNextDiscussionPage(next + 1));\r\n      }.bind(this),\r\n\r\n      pageList: function () {\r\n        let p = [],\r\n          left = Math.max(parseInt(this.page().number) - this.options.leftEdges, 1),\r\n          right = Math.min(parseInt(this.page().number) + this.options.rightEdges, this.totalPages());\r\n\r\n        for (let i = left; i <= right; i++) {\r\n          p.push(i);\r\n        }\r\n\r\n        return p;\r\n      }.bind(this),\r\n    };\r\n\r\n    m.redraw();\r\n  });\r\n\r\n  extend(DiscussionList.prototype, 'view', function (view) {\r\n    const state = this.attrs.state;\r\n\r\n    if (!state.usePaginationMode) {\r\n      return;\r\n    }\r\n\r\n    const params = state.getParams();\r\n\r\n    let DiscussionListView;\r\n\r\n    if (state.isEmpty()) {\r\n      const text = app.translator.trans('core.forum.discussion_list.empty_text');\r\n      DiscussionListView = Placeholder.component({ text });\r\n      view.children = [];\r\n      view.children.push(DiscussionListView);\r\n      return;\r\n    }\r\n\r\n    if (!state.isLoading()) {\r\n      let dicussionsOnPage = [];\r\n      const pages = state.getPages();\r\n\r\n      for (let index = 0; index < pages.length; index++) {\r\n        const page = pages[index];\r\n        if (page.number == state.location.page) {\r\n          page.items.map((discussion) => {\r\n            dicussionsOnPage.push(\r\n              <li key={discussion.id()} data-id={discussion.id()}>\r\n                {DiscussionListItem.component({ discussion, params })}\r\n              </li>\r\n            );\r\n          });\r\n          break;\r\n        }\r\n      }\r\n\r\n      DiscussionListView = <ul className=\"DiscussionList-discussions\">{dicussionsOnPage.map((i) => i)}</ul>;\r\n\r\n      view.children = [];\r\n      view.children.push(DiscussionListView);\r\n\r\n      let buttonFirst = Button.component({\r\n        title: 'First',\r\n        icon: 'fa fa-angle-double-left',\r\n        className: 'Button Button--icon',\r\n        onclick: () => {\r\n          state.ctrl.toPage(1);\r\n        },\r\n      });\r\n      let buttonBack = Button.component({\r\n        title: 'Back',\r\n        icon: 'fa fa-angle-left',\r\n        className: 'Button Button--icon',\r\n        onclick: () => {\r\n          let page = state.page().number;\r\n          state.ctrl.toPage(parseInt(page) - 1);\r\n        },\r\n      });\r\n      let buttonNext = Button.component({\r\n        title: 'Next',\r\n        icon: 'fa fa-angle-right',\r\n        className: 'Button Button--icon',\r\n        onclick: () => {\r\n          let page = state.page().number;\r\n          state.ctrl.toPage(parseInt(page) + 1);\r\n        },\r\n      });\r\n      let buttonLast = Button.component({\r\n        title: 'Last',\r\n        icon: 'fa fa-angle-double-right',\r\n        className: 'Button Button--icon',\r\n        onclick: () => {\r\n          let page = parseInt(state.totalPages());\r\n          state.ctrl.toPage(parseInt(page));\r\n        },\r\n      });\r\n\r\n      function JumpFunc() {\r\n        let input = parseInt(document.getElementById('pagination-inputJump').value);\r\n        if (Number.isFinite(input) && Number.isSafeInteger(input)) {\r\n          if (input != state.page().number) {\r\n            if (1 <= input && input <= state.totalPages()) {\r\n              state.ctrl.toPage(input);\r\n            }\r\n          }\r\n        }\r\n      }\r\n      let inputJump = m('input.FromControl', {\r\n        id: 'pagination-inputJump',\r\n        placeholder: state.page().number === undefined ? '' : `${state.page().number}`,\r\n        onkeydown: (event) => {\r\n          event.redraw = false;\r\n          if (event.keyCode == 13) {\r\n            event.redraw = true;\r\n            JumpFunc();\r\n          }\r\n        },\r\n      });\r\n      let buttonJump = Button.component({\r\n        title: 'Jump',\r\n        icon: 'fas fa-paper-plane',\r\n        className: 'Button Button--icon',\r\n        onclick: JumpFunc,\r\n      });\r\n\r\n      let buttonPage = [];\r\n      let buttons;\r\n      let toolbar;\r\n\r\n      state.ctrl.pageList().map(function (page) {\r\n        let me = this;\r\n        buttonPage.push(\r\n          Button.component(\r\n            {\r\n              title: parseInt(page),\r\n              icon: '',\r\n              className: page == me.page().number ? 'Button Button--primary' : 'Button',\r\n              'data-page': page,\r\n              onclick:\r\n                page != me.page().number\r\n                  ? () => {\r\n                      me.ctrl.toPage(parseInt(page));\r\n                    }\r\n                  : '',\r\n            },\r\n            m('strong', { className: '' }, parseInt(page))\r\n          )\r\n        );\r\n      }, state);\r\n\r\n      buttons = [buttonFirst].concat(buttonBack, buttonPage, buttonNext, buttonLast, inputJump, buttonJump);\r\n\r\n      toolbar = {\r\n        view: function (vnode) {\r\n          return m(\r\n            'div',\r\n            { id: 'toolbar' + Math.floor(Math.random() * 10 + 1), className: 'Pagination' },\r\n            m(\r\n              'ul',\r\n              { class: 'IndexPage-toolbar-view' },\r\n              vnode.attrs.groupbuttons.map((ibutton) => {\r\n                return m('li', { class: '' }, ibutton);\r\n              })\r\n            )\r\n          );\r\n        },\r\n      };\r\n\r\n      app.forum.attribute('foskym-pagination.paginationPosition') == 'above' && !state.isLoading()\r\n        ? view.children.unshift(m(toolbar, { groupbuttons: buttons }))\r\n        : '';\r\n      app.forum.attribute('foskym-pagination.paginationPosition') == 'under' && !state.isLoading()\r\n        ? view.children.push(m(toolbar, { groupbuttons: buttons }))\r\n        : '';\r\n      app.forum.attribute('foskym-pagination.paginationPosition') == 'both' && !state.isLoading()\r\n        ? view.children.unshift(m(toolbar, { groupbuttons: buttons })) && view.children.push(m(toolbar, { groupbuttons: buttons }))\r\n        : '';\r\n    }\r\n  });\r\n\r\n  extend(DiscussionControls, 'deleteAction', function () {\r\n    if (!this.usePaginationMode) {\r\n      return;\r\n    }\r\n\r\n    if (app.discussions) {\r\n      let page = app.discussions.location.page;\r\n      app.discussions.refresh(page);\r\n    }\r\n  });\r\n\r\n  extend(DiscussionComposer.prototype, 'onsubmit', function () {\r\n    if (!this.usePaginationMode) {\r\n      return;\r\n    }\r\n\r\n    if (app.discussions) {\r\n      // let page = app.discussions.location.page;\r\n      app.discussions.refresh();\r\n    }\r\n  });\r\n});\r\n","import app from 'flarum/forum/app';\r\nimport { extend } from 'flarum/common/extend';\r\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\r\nimport FieldSet from 'flarum/common/components/FieldSet';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport Switch from 'flarum/common/components/Switch';\r\nimport Stream from 'flarum/common/utils/Stream';\r\n\r\nexport default function () {\r\n  extend(SettingsPage.prototype, 'oninit', function () {\r\n    const user = this.user as any;\r\n    const preferences = user.preferences() as any;\r\n    this.userCustom = Stream(preferences['foskym-pagination.userCustom']);\r\n    this.userPaginationOnLoading = Stream(preferences['foskym-pagination.userPaginationOnLoading']);\r\n  });\r\n\r\n  extend(SettingsPage.prototype, 'settingsItems', function (items) {\r\n    if (Boolean(app.forum.attribute('foskym-pagination.canUserPref'))) {\r\n      items.add(\r\n        'pagination_settings',\r\n        FieldSet.component(\r\n          {\r\n            label: app.translator.trans('foskym-pagination.forum.user.settings.head'),\r\n            className: 'SettingsPage-pagination',\r\n          },\r\n          this.Pagination_UserPrefItems().toArray()\r\n        )\r\n      );\r\n    }\r\n  });\r\n\r\n  SettingsPage.prototype['Pagination_UserPrefItems'] = function () {\r\n    const items = new ItemList();\r\n    items.add(\r\n      'foskym-pagination.userCustom',\r\n      Switch.component(\r\n        {\r\n          state: this.user.preferences()['foskym-pagination.userCustom'],\r\n          onchange: (value) => {\r\n            this.UserCustom_Loading = true;\r\n            this.user.savePreferences({ 'foskym-pagination.userCustom': value }).then(() => {\r\n              this.UserCustom_Loading = false;\r\n              m.redraw();\r\n            });\r\n          },\r\n          loading: this.UserCustom_Loading,\r\n        },\r\n        app.translator.trans('foskym-pagination.forum.user.settings.userCustom')\r\n      )\r\n    );\r\n\r\n    if (this.user.preferences()['foskym-pagination.userCustom']) {\r\n      items.add(\r\n        'foskym-pagination.userPaginationOnLoading',\r\n        Switch.component(\r\n          {\r\n            state: this.user.preferences()['foskym-pagination.userPaginationOnLoading'],\r\n            onchange: (value) => {\r\n              this.userPaginationOnLoading_Loading = true;\r\n              this.user.savePreferences({ 'foskym-pagination.userPaginationOnLoading': value }).then(() => {\r\n                this.userPaginationOnLoading_Loading = false;\r\n                m.redraw();\r\n              });\r\n            },\r\n            loading: this.userPaginationOnLoading_Loading,\r\n          },\r\n          app.translator.trans('foskym-pagination.forum.user.settings.userPaginationOnLoading')\r\n        )\r\n      );\r\n    }\r\n\r\n    return items;\r\n  };\r\n}\r\n","import app from 'flarum/forum/app';\r\n\r\nexport default function () {\r\n  if (app.session.user === null) {\r\n    return app.forum.attribute('foskym-pagination.paginationOnLoading');\r\n  }\r\n\r\n  const preferences = app.session.user.preferences() as any;\r\n\r\n  if (app.forum.attribute('foskym-pagination.canUserPref')) {\r\n    if (!preferences['foskym-pagination.userCustom']) {\r\n      return app.forum.attribute('foskym-pagination.paginationOnLoading');\r\n    } else {\r\n      if (!preferences['foskym-pagination.userPaginationOnLoading']) {\r\n        return false;\r\n      }\r\n    }\r\n  } else {\r\n    return app.forum.attribute('foskym-pagination.paginationOnLoading');\r\n  }\r\n\r\n  return true;\r\n}\r\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","_extends","assign","bind","target","i","arguments","length","source","apply","this","flarum","core","compat","app","extend","SettingsPage","preferences","user","userCustom","Stream","userPaginationOnLoading","items","Boolean","add","FieldSet","label","className","Pagination_UserPrefItems","toArray","ItemList","Switch","state","onchange","UserCustom_Loading","savePreferences","then","m","redraw","loading","userPaginationOnLoading_Loading","override","DiscussionListState","original","page","options","perPage","perLoadMore","perIndexInit","leftEdges","rightEdges","usePaginationMode","determineMode","initialLoading","loadingPrev","loadingNext","clear","location","loadPage","results","pages","parseResults","pageSize","newOffset","newLimit","reqParams","requestParams","include","Array","isArray","join","Math","min","max","params","offset","limit","type","pg","pageNum","Number","links","payload","number","hasNext","next","hasPrev","prev","hasPage","allPages","getPages","push","totalDiscussionCount","jsonapi","totalResultsCount","getTotalPages","ceil","totalPages","ctrl","prevPage","current","nextPage","toPage","pageList","p","left","parseInt","right","DiscussionList","view","attrs","DiscussionListView","getParams","isEmpty","text","Placeholder","children","isLoading","JumpFunc","input","document","getElementById","isFinite","isSafeInteger","dicussionsOnPage","index","map","discussion","id","DiscussionListItem","buttons","toolbar","buttonFirst","Button","title","icon","onclick","buttonBack","buttonNext","buttonLast","inputJump","placeholder","undefined","onkeydown","event","keyCode","buttonJump","buttonPage","me","concat","vnode","floor","random","class","groupbuttons","ibutton","unshift","DiscussionControls","DiscussionComposer"],"sourceRoot":""}