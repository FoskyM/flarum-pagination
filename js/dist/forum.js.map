{"version":3,"file":"forum.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDR,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFf,EAAyBM,IACH,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,GAAO,G,+BCL9D,MAAM,EAA+BC,OAAOC,KAAKC,OAAO,c,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,iBCAlD,EAA+BF,OAAOC,KAAKC,OAAO,uC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,kC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,a,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,iC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,8B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,yB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,uB,aCAzC,SAASC,IAYtB,OAXAA,EAAWf,OAAOgB,OAAShB,OAAOgB,OAAOC,OAAS,SAAUC,GAC1D,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CACzC,IAAIG,EAASF,UAAUD,GACvB,IAAK,IAAIrB,KAAOwB,EACVtB,OAAOM,UAAUC,eAAeC,KAAKc,EAAQxB,KAC/CoB,EAAOpB,GAAOwB,EAAOxB,GAG3B,CACA,OAAOoB,CACT,EACOH,EAASQ,MAAMC,KAAMJ,UAC9B,CCbA,MAAM,EAA+BR,OAAOC,KAAKC,OAAO,oC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,mC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,uC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,iC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,sC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,0B,aCAzC,SAASW,EAAgB1B,EAAG2B,GAKzC,OAJAD,EAAkBzB,OAAO2B,eAAiB3B,OAAO2B,eAAeV,OAAS,SAAyBlB,EAAG2B,GAEnG,OADA3B,EAAE6B,UAAYF,EACP3B,CACT,EACO0B,EAAgB1B,EAAG2B,EAC5B,CCNA,MAAM,EAA+Bd,OAAOC,KAAKC,OAAO,oB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCInCe,EAAO,YCHb,IAAwBC,EAAUC,EDGrB,uFACrB,OADqB,0CAC1BC,WAAK,ICJ0CD,EDGrB,GCHWD,EDGX,GCFjBxB,UAAYN,OAAOiC,OAAOF,EAAWzB,WAC9CwB,EAASxB,UAAU4B,YAAcJ,EACjCH,EAAeG,EAAUC,GDCpB,kBAyHJ,OAzHI,EACLI,KAAA,SAAKC,GACH,IAAIC,EAAQb,KAAKQ,MAAMK,MACvB,OACE,SAAKC,UAAU,cACb,QAAIC,MAAM,0BACR,YAAKf,KAAKgB,eACV,YAAKhB,KAAKiB,cACTJ,EAAMK,KAAKC,WAAWC,KAAI,SAACC,GAC1B,OACE,YACE,EAAC,IAAM,CACLC,MAAOD,EACPP,UAAWD,EAAMQ,OAAOE,QAAUF,EAAO,wCAA0C,SACnFG,QAAS,WACPX,EAAMK,KAAKO,OAAOJ,EACpB,GAECA,GAIT,IACA,YAAKrB,KAAK0B,cACV,YAAK1B,KAAK2B,cACV,YAAK3B,KAAK4B,aACV,YAAK5B,KAAK6B,eAIlB,EAAC,EAEDb,YAAA,WACE,IAAIH,EAAQb,KAAKQ,MAAMK,MACvB,OAAOiB,IAAAA,UAAiB,CACtBR,MAAO,QACPS,KAAM,0BACNjB,UAAW,sBACXU,QAAS,WACPX,EAAMK,KAAKO,OAAO,EACpB,EACAO,SAAiC,GAAvBnB,EAAMQ,OAAOE,QAE3B,EAAC,EAEDN,WAAA,WACE,IAAIJ,EAAQb,KAAKQ,MAAMK,MACvB,OAAOiB,IAAAA,UAAiB,CACtBR,MAAO,OACPS,KAAM,mBACNjB,UAAW,sBACXU,QAAS,WACP,IAAIH,EAAOR,EAAMQ,OAAOE,OACxBV,EAAMK,KAAKO,OAAOQ,SAASZ,GAAQ,EACrC,EACAW,SAAiC,GAAvBnB,EAAMQ,OAAOE,QAE3B,EAAC,EAEDG,WAAA,WACE,IAAIb,EAAQb,KAAKQ,MAAMK,MACvB,OAAOiB,IAAAA,UAAiB,CACtBR,MAAO,OACPS,KAAM,oBACNjB,UAAW,sBACXU,QAAS,WACP,IAAIH,EAAOR,EAAMQ,OAAOE,OACxBV,EAAMK,KAAKO,OAAOQ,SAASZ,GAAQ,EACrC,EACAW,SAAUnB,EAAMQ,OAAOE,QAAUV,EAAMqB,cAE3C,EAAC,EAEDP,WAAA,WACE,IAAId,EAAQb,KAAKQ,MAAMK,MACvB,OAAOiB,IAAAA,UAAiB,CACtBR,MAAO,OACPS,KAAM,2BACNjB,UAAW,sBACXU,QAAS,WACP,IAAIH,EAAOY,SAASpB,EAAMqB,cAC1BrB,EAAMK,KAAKO,OAAOJ,EACpB,EACAW,SAAUnB,EAAMQ,OAAOE,QAAUV,EAAMqB,cAE3C,EAAC,EAEDC,SAAA,WAAW,MACLtB,EAAQb,KAAKQ,MAAMK,MACnBuB,EAAQH,SAAwD,OAAhD,EAACI,SAASC,eAAe,8BAAuB,EAA/C,EAAiDnD,OAClEoD,OAAOC,SAASJ,IAAUG,OAAOE,cAAcL,IAC7CA,GAASvB,EAAMQ,OAAOE,QACpB,GAAKa,GAASA,GAASvB,EAAMqB,cAC/BrB,EAAMK,KAAKO,OAAOW,EAI1B,EAAC,EAEDR,UAAA,WAAY,WACNf,EAAQb,KAAKQ,MAAMK,MACvB,OAAO6B,EAAE,oBAAqB,CAC5BC,GAAI,uBACJC,iBAAqCC,IAAxBhC,EAAMQ,OAAOE,OAAuB,GAAK,GAAGV,EAAMQ,OAAOE,OACtEuB,UAAW,SAACC,GACVA,EAAMC,QAAS,EACM,IAAjBD,EAAME,UACRF,EAAMC,QAAS,EACf,EAAKb,WAET,GAEJ,EAAC,EAEDN,WAAA,WACE,OAAOC,IAAAA,UAAiB,CACtBR,MAAO,OACPS,KAAM,oBACNjB,UAAW,sBACXU,QAASxB,KAAKmC,SAAS1C,KAAKO,OAEhC,EAAC,EA1HyB,CAASkD,KEOrCC,IAAAA,aAAAA,IAAqB,4BAA4B,YCF/CC,EAAAA,EAAAA,QAAOC,IAAAA,UAAwB,UAAU,WACvC,IACMC,EADOtD,KAAKuD,KACOD,cACzBtD,KAAKwD,WAAaC,IAAOH,EAAY,iCACrCtD,KAAK0D,wBAA0BD,IAAOH,EAAY,6CACpD,KAEAF,EAAAA,EAAAA,QAAOC,IAAAA,UAAwB,iBAAiB,SAAUM,GACpDC,QAAQT,IAAAA,MAAAA,UAAoB,mCAC9BQ,EAAME,IACJ,sBACAC,IAAAA,UACE,CACEC,MAAOZ,IAAAA,WAAAA,MAAqB,8CAC5BrC,UAAW,2BAEbd,KAAKgE,2BAA2BC,WAIxC,IAEAZ,IAAAA,UAAAA,yBAAqD,WAAY,WACzDM,EAAQ,IAAIO,KAuClB,OAtCAP,EAAME,IACJ,+BACAM,IAAAA,UACE,CACEtD,MAAOb,KAAKuD,KAAKD,cAAc,gCAC/Bc,SAAU,SAACjF,GACT,EAAKkF,oBAAqB,EAC1B,EAAKd,KAAKe,gBAAgB,CAAE,+BAAgCnF,IAASoF,MAAK,WACxE,EAAKF,oBAAqB,EAC1B3B,EAAEM,QACJ,GACF,EACAwB,QAASxE,KAAKqE,oBAEhBlB,IAAAA,WAAAA,MAAqB,sDAIrBnD,KAAKuD,KAAKD,cAAc,iCAC1BK,EAAME,IACJ,4CACAM,IAAAA,UACE,CACEtD,MAAOb,KAAKuD,KAAKD,cAAc,6CAC/Bc,SAAU,SAACjF,GACT,EAAKsF,iCAAkC,EACvC,EAAKlB,KAAKe,gBAAgB,CAAE,4CAA6CnF,IAASoF,MAAK,WACrF,EAAKE,iCAAkC,EACvC/B,EAAEM,QACJ,GACF,EACAwB,QAASxE,KAAKyE,iCAEhBtB,IAAAA,WAAAA,MAAqB,mEAKpBQ,CACT,EChEAe,IAAAA,UAAAA,YAA4C,WAC1C1E,KAAK2E,QAAU,CACbC,iBAAkBzB,IAAAA,MAAAA,UAAoB,sCACtC0B,QAAS1B,IAAAA,MAAAA,UAAoB,6BAC7B2B,YAAa3B,IAAAA,MAAAA,UAAoB,iCACjC4B,aAAc5B,IAAAA,MAAAA,UAAoB,kCAClC6B,UAAW,EACXC,WAAY,GAEdjF,KAAKkF,kBCfM,WACb,GAAyB,OAArB/B,IAAAA,QAAAA,KACF,OAAOA,IAAAA,MAAAA,UAAoB,yCAG7B,IAAMG,EAAcH,IAAAA,QAAAA,KAAAA,cAEpB,OAAIA,IAAAA,MAAAA,UAAoB,kCACjBG,EAAY,kCAGVA,EAAY,6CAKZH,IAAAA,MAAAA,UAAoB,wCAI/B,CDL6BgC,GACzBnF,KAAKoF,yBAA2B,EAChCpF,KAAKqF,eAAiB,EACtBrF,KAAKsF,gBAAkB,GACvBtF,KAAKuF,eAAiB,CAAC,EACvBvF,KAAKwF,iBAAmB,CAAC,EAEzBxF,KAAKyF,cAAe,CACtB,GAEAC,EAAAA,EAAAA,UAAShB,IAAAA,UAA+B,WAAW,SAAUiB,EAAUtE,GAAU,WAG/E,YAHyE,IAAJA,IAAAA,EAAO,GACvErB,KAAKyF,cAAczF,KAAK4F,cAExB5F,KAAKkF,mBAKVlF,KAAK6F,gBAAiB,EACtB7F,KAAK8F,aAAc,EACnB9F,KAAK+F,aAAc,EAEnB/F,KAAKgG,cAAe,EAEpBhG,KAAKiG,QAELjG,KAAKkG,SAAW,CAAE7E,KAAAA,GAEXrB,KAAKmG,SAAS9E,GAClBkD,MAAK,SAAC6B,GACL,EAAKC,MAAQ,GACb,EAAKC,aAAa,EAAKJ,SAAS7E,KAAM+E,EACxC,IAAE,SACO,WACP,EAAKP,gBAAiB,EACtB,EAAKG,cAAe,CACtB,MAtBAhG,KAAKuG,SAAWvG,KAAK2E,QAAQG,YACtBa,EAAStE,GAsBpB,KAEAqE,EAAAA,EAAAA,UAAShB,IAAAA,UAA+B,YAAY,SAAUiB,EAAUtE,QAAI,IAAJA,IAAAA,EAAO,GAC7E,IAAMmF,EAAYxG,KAAKyG,gBAClBzG,KAAKyF,cAAczF,KAAK4F,cACxB5F,KAAKwF,iBAA0B,UAClCxF,KAAKwF,iBAAmBgB,GAG1B,IAAME,EAAuBvD,IAAAA,uBAC7B,GAAIuD,EAMF,OALA1G,KAAK6F,gBAAiB,EACtB7F,KAAKgG,cAAe,EACpBhG,KAAK2G,qBAAuBlD,IAAOiD,EAAqBE,QAAQC,QAAQC,mBACxE9G,KAAKoF,yBAA2BpF,KAAK2G,uBAE9BI,QAAQC,QAAQN,GAGzB,IAAK1G,KAAKgG,cAAgBhG,KAAK2E,QAAQC,mBAEnCqC,KAAKC,UAAUV,EAAmB,WAAOS,KAAKC,UAAUlH,KAAKwF,iBAA0B,UACvFyB,KAAKC,UAAUV,EAAkB,UAAOS,KAAKC,UAAUlH,KAAKwF,iBAAiB,cAC7EgB,EAAgB,OAAMxG,KAAKwF,iBAAuB,OAE9CxF,KAAKuF,eAAelE,GAAO,CAC7B,IAAI8F,EAAQnH,KAAK2E,QAAQE,SAAWxD,EAAO,GACvC+F,EAAMpH,KAAK2E,QAAQE,QAAUxD,EAC7B+E,EAAUpG,KAAKsF,gBAAgB+B,MAAMF,EAAOC,GAEhD,OADAhB,EAAQQ,QAAU,CAAEC,QAAS,CAAEC,kBAAmB9G,KAAK2G,yBAChDI,QAAQC,QAAQZ,EACzB,CAIJ,IAEIkB,EAAWC,EAFTC,EAAUC,MAAMC,QAAQlB,EAAUgB,SAAWhB,EAAUgB,QAAQG,KAAK,KAAOnB,EAAUgB,QAIvFxH,KAAKkF,mBACPoC,EAAYtH,KAAK2E,QAAQE,SAAWxD,EAAO,GAC3CkG,EAAWvH,KAAK2E,QAAQE,SAGxB0C,EAAwB,IADxBD,EAAYtH,KAAK2E,QAAQI,aAAe6C,KAAKC,IAAIxG,EAAO,EAAG,GAAKrB,KAAK2E,QAAQG,YAAc8C,KAAKE,IAAIzG,EAAO,EAAG,IAClFrB,KAAK2E,QAAQI,aAAe/E,KAAK2E,QAAQG,YAGvE,IAAMiD,EAAS,KACVvB,EAAS,CACZnF,KAAM,KACDmF,EAAUnF,KAAI,CACjB2G,OAAQV,EACRW,MAAOV,IAETC,QAAAA,IAGF,OAAOrE,IAAAA,MAAAA,KAAenD,KAAKkI,KAAMH,EACnC,KAEArC,EAAAA,EAAAA,UAAShB,IAAAA,UAA+B,gBAAgB,SAAUiB,EAAUwC,EAAI/B,GAAS,MACvF,IAAKpG,KAAKkF,kBACR,OAAOS,EAASwC,EAAI/B,GAEtB,IAAMgC,EAAU7F,OAAO4F,GAEjBE,GAAuB,OAAf,EAAAjC,EAAQQ,cAAO,EAAf,EAAiByB,QAAS,CAAC,EAEnChH,EAAO,CACXE,OAAQ6G,EACRzE,MAAOyC,EACPkC,UAAgB,MAALD,IAAAA,EAAOE,MAClBC,UAAgB,MAALH,IAAAA,EAAOI,OAoBpB,GAjBAzI,KAAK0I,QAAU,SAAUrH,GACvB,IAAIsH,EAAW3I,KAAK4I,WACpB,GAAuB,GAAnBD,EAAS9I,OAAa,OAAO,EACjC,IAAK,IAAIF,EAAI,EAAGA,EAAIgJ,EAAS9I,OAAQF,IACnC,GAAIgJ,EAAShJ,GAAG4B,QAAUF,EAAM,OAAO,EAEzC,OAAO,CACT,EAEKrB,KAAK0I,QAAQN,IAChBpI,KAAKqG,MAAMwC,KAAKxH,GAGlBrB,KAAKkG,SAAW,CAAE7E,KAAM+G,GAExBpI,KAAK2G,qBAAuBlD,IAAO2C,EAAQQ,QAAQC,QAAQC,mBAEvD9G,KAAK2E,QAAQC,iBACf,GACG5E,KAAKoF,0BAA4BpF,KAAK2G,wBAA2D,GAAjC3G,KAAKoF,0BACpC,IAAlCpF,KAAKoF,0BACLpF,KAAKgG,aACL,CAEAhG,KAAKoF,yBAA2BpF,KAAK2G,uBACrC,IAAK,IAAIhH,EAAI,EAAGA,EAAIK,KAAKoF,yBAA0BzF,IACjDK,KAAKsF,gBAAgB3F,GAAK,CAAC,EAE7BK,KAAKuF,eAAiB,CAAC,CACzB,KAAO,OAELvF,KAAKuF,eAAe6C,GAAW/G,EAC/B,IAAI8F,EAAQnH,KAAK2E,QAAQE,SAAWuD,EAAU,GAC1ChB,EAAMpH,KAAK2E,QAAQE,QAAUuD,GACjC,EAAApI,KAAKsF,iBAAgBwD,OAAM,SAAC3B,EAAOC,EAAMD,GAAK,OAAKf,GACrD,CAGFpG,KAAK+I,cAAgB,WACnB,OAAOnB,KAAKoB,KAAKhJ,KAAK2G,uBAAyB3G,KAAK2E,QAAQE,QAC9D,EAEA7E,KAAKqB,KAAOoC,IAAOpC,GACnBrB,KAAK6E,QAAUpB,IAAOzD,KAAK2E,QAAQE,SACnC7E,KAAKkC,WAAauB,IAAOzD,KAAK+I,iBAE9B/I,KAAKkB,KAAO,CACV+H,SAAU,WAAY,WAChBC,EAAUlJ,KAAKqB,OAAOE,OAG1B,OAFE2H,EAEY,GAAd,CAIAlJ,KAAKqB,KAAK6H,GACV,IAAIX,EAAOW,EACXlJ,KAAK8F,aAAc,EACnB9F,KAAKmG,SAASoC,GAAMhE,MAAK,SAAC6B,GACxB,EAAKE,aAAaiC,EAAMnC,GACxB,EAAKN,aAAc,CACrB,GARA,CASF,EAAErG,KAAKO,MAEPmJ,SAAU,WAAY,WAChBD,EAAUlJ,KAAKqB,OAAOE,OAG1B,KAFE2H,EAEYlJ,KAAKkC,aACjBgH,EAAUlJ,KAAKkC,iBADjB,CAKAlC,KAAKqB,KAAK6H,GACV,IAAIX,EAAOW,EACXlJ,KAAK+F,aAAc,EACnB/F,KAAKmG,SAASoC,GAAMhE,MAAK,SAAC6B,GACxB,EAAKE,aAAaiC,EAAMnC,GACxB,EAAKL,aAAc,CACrB,GARA,CASF,EAAEtG,KAAKO,MAEPyB,OAAQ,SAAUJ,GAAM,WACtB,KAAIrB,KAAKqB,OAAOE,QAAUgB,OAAOlB,IAASA,EAAO,GAAKA,EAAOrB,KAAKkC,cAAlE,CAEAlC,KAAKqB,KAAKkB,OAAOlB,IACjB,IAAIkH,EAAOhG,OAAOlB,GAElBrB,KAAK6F,gBAAiB,EAEtB7F,KAAKmG,SAASoC,GAAMhE,MAAK,SAAC6B,GACxB,EAAKE,aAAaiC,EAAMnC,GACxB,EAAKP,gBAAiB,CACxB,GAVsF,CAWxF,EAAEpG,KAAKO,MAEPmB,SAAU,WAKR,IAJA,IAAIjB,EAAI,GACNkJ,EAAOxB,KAAKE,IAAI7F,SAASjC,KAAKqB,OAAOE,QAAUvB,KAAK2E,QAAQK,UAAW,GACvEqE,EAAQzB,KAAKC,IAAI5F,SAASjC,KAAKqB,OAAOE,QAAUvB,KAAK2E,QAAQM,WAAYjF,KAAKkC,cAEvEvC,EAAIyJ,EAAMzJ,GAAK0J,EAAO1J,IAC7BO,EAAE2I,KAAKlJ,GAGT,OAAOO,CACT,EAAET,KAAKO,OAGT0C,EAAEM,QACJ,KAEA0C,EAAAA,EAAAA,UAAShB,IAAAA,UAA+B,iBAAiB,SAAUiB,EAAU2D,GAC3E,IAAKtJ,KAAKkF,kBACR,OAAOS,IAET,IAAM4D,EAAQvJ,KAAKsF,gBAAgBkE,QAAQF,IAE5B,IAAXC,GACFvJ,KAAKsF,gBAAgBwD,OAAOS,GAC5BvJ,KAAKsF,gBAAgBmE,QAAQH,KAE7BtJ,KAAKsF,gBAAgBmE,QAAQH,GAC7BtJ,KAAKoF,2BACLpF,KAAK2G,qBAAqB3G,KAAKoF,2BAGjC1C,EAAEM,QACJ,KAEA0C,EAAAA,EAAAA,UAAShB,IAAAA,UAA+B,oBAAoB,SAAUiB,EAAU2D,GAC9E,IAAKtJ,KAAKkF,kBACR,OAAOS,IAET,IAAM4D,EAAQvJ,KAAKsF,gBAAgBkE,QAAQF,IAE5B,IAAXC,IACFvJ,KAAKsF,gBAAgBwD,OAAOS,GAC5BvJ,KAAKoF,2BACLpF,KAAK2G,qBAAqB3G,KAAKoF,2BAGjC1C,EAAEM,QACJ,KAEA0C,EAAAA,EAAAA,UAAShB,IAAAA,UAA+B,SAAS,SAAUiB,GACzD,OAAK3F,KAAKkF,mBAGVlF,KAAKsF,gBAAkB,GACvBtF,KAAKuF,eAAiB,CAAC,EACvBvF,KAAKwF,iBAAmB,CAAC,EACzBxF,KAAKoF,yBAA2B,EAChCpF,KAAKqF,eAAiB,EACtBrF,KAAK2G,qBAAuBlD,IAAO,GAC5BkC,KAREA,GASX,KEnRAD,EAAAA,EAAAA,UAASgE,IAAAA,UAA0B,QAAQ,SAAU/D,GACnD,IAAM9E,EAAQb,KAAKQ,MAAMK,MAEzB,IAAKA,EAAMqE,kBACT,OAAOS,IAGT,IAAMoC,EAASlH,EAAM8I,YACfC,EAAY/I,EAAM+I,YAExB,GAAI/I,EAAMgJ,UAAW,CACnB,IAAMC,EAAO3G,IAAAA,WAAAA,MAAqB,yCAClC,OACE,SAAKrC,UAAU,kBACb,EAAC,IAAW,CAACgJ,KAAMA,IAGzB,CAEA,GAAIF,EACF,OACE,SAAK9I,UAAWiJ,IAAU,iBAAkB,CAAE,gCAAiClJ,EAAMmJ,qBACnF,QAAIC,KAAK,OAAO,YAAWL,EAAW9I,UAAU,+BAChD,SAAKA,UAAU,2BACb,EAAC,IAAgB,QASzB,IAHA,IAAMuF,EAAQxF,EAAM+H,WAChBjF,EAAQ,GAEH4F,EAAQ,EAAGA,EAAQlD,EAAMxG,OAAQ0J,IAAS,CACjD,IAAMlI,EAAOgF,EAAMkD,GACnB,GAAIlI,EAAKE,QAAUV,EAAMqF,SAAS7E,KAAM,CACtCsC,EAAQtC,EAAKsC,MACb,KACF,CACF,CAEA,IAAMuG,EAAW/G,IAAAA,MAAAA,UAAoB,wCAC/BoD,EAAW1F,EAAM8D,QAAQE,QACzBuD,EAAUvH,EAAMQ,KAEtB,OACE,SAAKP,UAAWiJ,IAAU,iBAAkB,CAAE,gCAAiClJ,EAAMmJ,qBACtE,SAAZE,GAAmC,QAAZA,EAAqB7J,EAAQ8J,UAAU,CAAEtJ,MAAAA,IAAW,GAC5E,QAAIoJ,KAAK,OAAO,YAAWL,EAAW9I,UAAU,8BAC7C6C,EAAMvC,KAAI,SAACkI,EAAYc,GAAO,OAC7B,QAAI9L,IAAKgL,EAAW3G,KAAM,UAAS2G,EAAW3G,KAAMsH,KAAK,UAAU,eAAa,KAAK,gBAAe7B,EAAU7B,EAAW6D,GACvH,EAAC,IAAkB,CAACd,WAAYA,EAAYvB,OAAQA,IACjD,KAGI,SAAZmC,GAAmC,QAAZA,EAAqB7J,EAAQ8J,UAAU,CAAEtJ,MAAAA,IAAW,GAGlF,KJpDAuC,EAAAA,EAAAA,QAAOiH,IAAoB,gBAAgB,WACzC,GAAKrK,KAAKkF,mBAIN/B,IAAAA,YAAiB,CACnB,IAAI9B,EAAO8B,IAAAA,YAAAA,SAAAA,KACXA,IAAAA,YAAAA,QAAwB9B,EAC1B,CACF,KAEA+B,EAAAA,EAAAA,QAAOkH,IAAAA,UAA8B,YAAY,WAC1CtK,KAAKkF,mBAIN/B,IAAAA,aAEFA,IAAAA,YAAAA,SAEJ,GACF,G","sources":["webpack://@foskym/flarum-pagination/webpack/bootstrap","webpack://@foskym/flarum-pagination/webpack/runtime/compat get default export","webpack://@foskym/flarum-pagination/webpack/runtime/define property getters","webpack://@foskym/flarum-pagination/webpack/runtime/hasOwnProperty shorthand","webpack://@foskym/flarum-pagination/webpack/runtime/make namespace object","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/app']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/extend']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/app']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/FieldSet']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@foskym/flarum-pagination/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/Placeholder']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@foskym/flarum-pagination/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/Component']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/Button']\"","webpack://@foskym/flarum-pagination/./src/forum/components/Toolbar.tsx","webpack://@foskym/flarum-pagination/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@foskym/flarum-pagination/./src/forum/index.js","webpack://@foskym/flarum-pagination/./src/forum/addUserPreference.js","webpack://@foskym/flarum-pagination/./src/forum/overrideDiscussionListState.js","webpack://@foskym/flarum-pagination/./src/forum/utils/determineMode.ts","webpack://@foskym/flarum-pagination/./src/forum/overrideDiscussionList.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/FieldSet'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionListItem'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Placeholder'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import Component from 'flarum/common/Component';\r\nimport Button from 'flarum/common/components/Button';\r\nimport type Mithril from 'mithril';\r\n\r\nexport default class Toolbar extends Component {\r\n  attrs: any;\r\n  view(vnode: Mithril.Vnode) {\r\n    let state = this.attrs.state;\r\n    return (\r\n      <div className=\"Pagination\">\r\n        <ul class=\"IndexPage-toolbar-view\">\r\n          <li>{this.buttonFirst()}</li>\r\n          <li>{this.buttonBack()}</li>\r\n          {state.ctrl.pageList().map((page: any) => {\r\n            return (\r\n              <li>\r\n                <Button\r\n                  title={page}\r\n                  className={state.page().number == page ? 'Button Button--primary Button--active' : 'Button'}\r\n                  onclick={() => {\r\n                    state.ctrl.toPage(page);\r\n                  }}\r\n                >\r\n                  {page}\r\n                </Button>\r\n              </li>\r\n            );\r\n          })}\r\n          <li>{this.buttonNext()}</li>\r\n          <li>{this.buttonLast()}</li>\r\n          <li>{this.inputJump()}</li>\r\n          <li>{this.buttonJump()}</li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  buttonFirst() {\r\n    let state = this.attrs.state;\r\n    return Button.component({\r\n      title: 'First',\r\n      icon: 'fa fa-angle-double-left',\r\n      className: 'Button Button--icon',\r\n      onclick: () => {\r\n        state.ctrl.toPage(1);\r\n      },\r\n      disabled: state.page().number == 1,\r\n    });\r\n  }\r\n\r\n  buttonBack() {\r\n    let state = this.attrs.state;\r\n    return Button.component({\r\n      title: 'Back',\r\n      icon: 'fa fa-angle-left',\r\n      className: 'Button Button--icon',\r\n      onclick: () => {\r\n        let page = state.page().number;\r\n        state.ctrl.toPage(parseInt(page) - 1);\r\n      },\r\n      disabled: state.page().number == 1,\r\n    });\r\n  }\r\n\r\n  buttonNext() {\r\n    let state = this.attrs.state;\r\n    return Button.component({\r\n      title: 'Next',\r\n      icon: 'fa fa-angle-right',\r\n      className: 'Button Button--icon',\r\n      onclick: () => {\r\n        let page = state.page().number;\r\n        state.ctrl.toPage(parseInt(page) + 1);\r\n      },\r\n      disabled: state.page().number == state.totalPages(),\r\n    });\r\n  }\r\n\r\n  buttonLast() {\r\n    let state = this.attrs.state;\r\n    return Button.component({\r\n      title: 'Last',\r\n      icon: 'fa fa-angle-double-right',\r\n      className: 'Button Button--icon',\r\n      onclick: () => {\r\n        let page = parseInt(state.totalPages());\r\n        state.ctrl.toPage(page);\r\n      },\r\n      disabled: state.page().number == state.totalPages(),\r\n    });\r\n  }\r\n\r\n  JumpFunc() {\r\n    let state = this.attrs.state;\r\n    let input = parseInt(document.getElementById('pagination-inputJump')?.value);\r\n    if (Number.isFinite(input) && Number.isSafeInteger(input)) {\r\n      if (input != state.page().number) {\r\n        if (1 <= input && input <= state.totalPages()) {\r\n          state.ctrl.toPage(input);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  inputJump() {\r\n    let state = this.attrs.state;\r\n    return m('input.FromControl', {\r\n      id: 'pagination-inputJump',\r\n      placeholder: state.page().number === undefined ? '' : `${state.page().number}`,\r\n      onkeydown: (event: KeyboardEvent) => {\r\n        event.redraw = false;\r\n        if (event.keyCode == 13) {\r\n          event.redraw = true;\r\n          this.JumpFunc();\r\n        }\r\n      },\r\n    });\r\n  }\r\n\r\n  buttonJump() {\r\n    return Button.component({\r\n      title: 'Jump',\r\n      icon: 'fa fa-paper-plane',\r\n      className: 'Button Button--icon',\r\n      onclick: this.JumpFunc.bind(this),\r\n    });\r\n  }\r\n}\r\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import app from 'flarum/common/app';\r\nimport { extend, override } from 'flarum/common/extend';\r\n\r\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\r\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\r\n\r\nimport addUserPreference from './addUserPreference';\r\nimport overrideDiscussionListState from './overrideDiscussionListState';\r\nimport overrideDiscussionList from './overrideDiscussionList';\r\n\r\n\r\napp.initializers.add('foskym/flarum-pagination', () => {\r\n  addUserPreference();\r\n  overrideDiscussionListState();\r\n  overrideDiscussionList();\r\n\r\n  extend(DiscussionControls, 'deleteAction', function () {\r\n    if (!this.usePaginationMode) {\r\n      return;\r\n    }\r\n\r\n    if (app.discussions) {\r\n      let page = app.discussions.location.page;\r\n      app.discussions.refresh(page);\r\n    }\r\n  });\r\n\r\n  extend(DiscussionComposer.prototype, 'onsubmit', function () {\r\n    if (!this.usePaginationMode) {\r\n      return;\r\n    }\r\n\r\n    if (app.discussions) {\r\n      // let page = app.discussions.location.page;\r\n      app.discussions.refresh();\r\n    }\r\n  });\r\n});\r\n","import app from 'flarum/forum/app';\r\nimport { extend } from 'flarum/common/extend';\r\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\r\nimport FieldSet from 'flarum/common/components/FieldSet';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport Switch from 'flarum/common/components/Switch';\r\nimport Stream from 'flarum/common/utils/Stream';\r\n\r\nexport default function () {\r\n  extend(SettingsPage.prototype, 'oninit', function () {\r\n    const user = this.user;\r\n    const preferences = user.preferences();\r\n    this.userCustom = Stream(preferences['foskym-pagination.userCustom']);\r\n    this.userPaginationOnLoading = Stream(preferences['foskym-pagination.userPaginationOnLoading']);\r\n  });\r\n\r\n  extend(SettingsPage.prototype, 'settingsItems', function (items) {\r\n    if (Boolean(app.forum.attribute('foskym-pagination.canUserPref'))) {\r\n      items.add(\r\n        'pagination_settings',\r\n        FieldSet.component(\r\n          {\r\n            label: app.translator.trans('foskym-pagination.forum.user.settings.head'),\r\n            className: 'SettingsPage-pagination',\r\n          },\r\n          this.Pagination_UserPrefItems().toArray()\r\n        )\r\n      );\r\n    }\r\n  });\r\n\r\n  SettingsPage.prototype['Pagination_UserPrefItems'] = function () {\r\n    const items = new ItemList();\r\n    items.add(\r\n      'foskym-pagination.userCustom',\r\n      Switch.component(\r\n        {\r\n          state: this.user.preferences()['foskym-pagination.userCustom'],\r\n          onchange: (value) => {\r\n            this.UserCustom_Loading = true;\r\n            this.user.savePreferences({ 'foskym-pagination.userCustom': value }).then(() => {\r\n              this.UserCustom_Loading = false;\r\n              m.redraw();\r\n            });\r\n          },\r\n          loading: this.UserCustom_Loading,\r\n        },\r\n        app.translator.trans('foskym-pagination.forum.user.settings.userCustom')\r\n      )\r\n    );\r\n\r\n    if (this.user.preferences()['foskym-pagination.userCustom']) {\r\n      items.add(\r\n        'foskym-pagination.userPaginationOnLoading',\r\n        Switch.component(\r\n          {\r\n            state: this.user.preferences()['foskym-pagination.userPaginationOnLoading'],\r\n            onchange: (value) => {\r\n              this.userPaginationOnLoading_Loading = true;\r\n              this.user.savePreferences({ 'foskym-pagination.userPaginationOnLoading': value }).then(() => {\r\n                this.userPaginationOnLoading_Loading = false;\r\n                m.redraw();\r\n              });\r\n            },\r\n            loading: this.userPaginationOnLoading_Loading,\r\n          },\r\n          app.translator.trans('foskym-pagination.forum.user.settings.userPaginationOnLoading')\r\n        )\r\n      );\r\n    }\r\n\r\n    return items;\r\n  };\r\n}\r\n","import app from 'flarum/common/app';\r\nimport { override } from 'flarum/common/extend';\r\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\r\nimport Stream from 'flarum/common/utils/Stream';\r\n\r\nimport determineMode from './utils/determineMode';\r\n\r\nexport default function () {\r\n  DiscussionListState.prototype.initOptions = function () {\r\n    this.options = {\r\n      cacheDiscussions: app.forum.attribute('foskym-pagination.cacheDiscussions'),\r\n      perPage: app.forum.attribute('foskym-pagination.perPage'),\r\n      perLoadMore: app.forum.attribute('foskym-pagination.perLoadMore'),\r\n      perIndexInit: app.forum.attribute('foskym-pagination.perIndexInit'),\r\n      leftEdges: 4,\r\n      rightEdges: 5,\r\n    };\r\n    this.usePaginationMode = determineMode();\r\n    this.lastTotalDiscussionCount = 0;\r\n    this.lastTotalPages = 0;\r\n    this.lastDiscussions = [];\r\n    this.lastLoadedPage = {};\r\n    this.lastRquestParams = {};\r\n\r\n    this.optionInited = true;\r\n  };\r\n\r\n  override(DiscussionListState.prototype, 'refresh', function (original, page = 1) {\r\n    if (!this.optionInited) this.initOptions();\r\n\r\n    if (!this.usePaginationMode) {\r\n      this.pageSize = this.options.perLoadMore;\r\n      return original(page);\r\n    }\r\n\r\n    this.initialLoading = true;\r\n    this.loadingPrev = false;\r\n    this.loadingNext = false;\r\n\r\n    this.isRefreshing = true;\r\n\r\n    this.clear();\r\n\r\n    this.location = { page };\r\n\r\n    return this.loadPage(page)\r\n      .then((results) => {\r\n        this.pages = [];\r\n        this.parseResults(this.location.page, results);\r\n      })\r\n      .finally(() => {\r\n        this.initialLoading = false;\r\n        this.isRefreshing = false;\r\n      });\r\n  });\r\n\r\n  override(DiscussionListState.prototype, 'loadPage', function (original, page = 1) {\r\n    const reqParams = this.requestParams();\r\n    if (!this.optionInited) this.initOptions();\r\n    if (!this.lastRquestParams['include']) {\r\n      this.lastRquestParams = reqParams;\r\n    }\r\n    \r\n    const preloadedDiscussions = app.preloadedApiDocument();\r\n    if (preloadedDiscussions) {\r\n      this.initialLoading = false;\r\n      this.isRefreshing = false;\r\n      this.totalDiscussionCount = Stream(preloadedDiscussions.payload.jsonapi.totalResultsCount);\r\n      this.lastTotalDiscussionCount = this.totalDiscussionCount();\r\n\r\n      return Promise.resolve(preloadedDiscussions);\r\n    }\r\n\r\n    if (!this.isRefreshing && this.options.cacheDiscussions) {\r\n      if (\r\n        JSON.stringify(reqParams['include']) !== JSON.stringify(this.lastRquestParams['include']) ||\r\n        JSON.stringify(reqParams['filter']) !== JSON.stringify(this.lastRquestParams['filter.q']) ||\r\n        reqParams['sort'] !== this.lastRquestParams['sort']\r\n      ) {\r\n        if (this.lastLoadedPage[page]) {\r\n          let start = this.options.perPage * (page - 1);\r\n          let end = this.options.perPage * page;\r\n          let results = this.lastDiscussions.slice(start, end);\r\n          results.payload = { jsonapi: { totalResultsCount: this.totalDiscussionCount() } };\r\n          return Promise.resolve(results);\r\n        }\r\n      }\r\n    }\r\n\r\n    const include = Array.isArray(reqParams.include) ? reqParams.include.join(',') : reqParams.include;\r\n\r\n    let newOffset, newLimit;\r\n\r\n    if (this.usePaginationMode) {\r\n      newOffset = this.options.perPage * (page - 1);\r\n      newLimit = this.options.perPage;\r\n    } else {\r\n      newOffset = this.options.perIndexInit * Math.min(page - 1, 1) + this.options.perLoadMore * Math.max(page - 2, 0);\r\n      newLimit = newOffset == 0 ? this.options.perIndexInit : this.options.perLoadMore;\r\n    }\r\n\r\n    const params = {\r\n      ...reqParams,\r\n      page: {\r\n        ...reqParams.page,\r\n        offset: newOffset,\r\n        limit: newLimit,\r\n      },\r\n      include,\r\n    };\r\n\r\n    return app.store.find(this.type, params);\r\n  });\r\n\r\n  override(DiscussionListState.prototype, 'parseResults', function (original, pg, results) {\r\n    if (!this.usePaginationMode) {\r\n      return original(pg, results);\r\n    }\r\n    const pageNum = Number(pg);\r\n\r\n    const links = results.payload?.links || {};\r\n\r\n    const page = {\r\n      number: pageNum,\r\n      items: results,\r\n      hasNext: !!links?.next,\r\n      hasPrev: !!links?.prev,\r\n    };\r\n\r\n    this.hasPage = function (page) {\r\n      let allPages = this.getPages();\r\n      if (allPages.length == 0) return false;\r\n      for (let i = 0; i < allPages.length; i++) {\r\n        if (allPages[i].number == page) return true;\r\n      }\r\n      return false;\r\n    };\r\n\r\n    if (!this.hasPage(pageNum)) {\r\n      this.pages.push(page);\r\n    }\r\n\r\n    this.location = { page: pageNum };\r\n\r\n    this.totalDiscussionCount = Stream(results.payload.jsonapi.totalResultsCount);\r\n\r\n    if (this.options.cacheDiscussions) {\r\n      if (\r\n        (this.lastTotalDiscussionCount != this.totalDiscussionCount() && this.lastTotalDiscussionCount != 0) ||\r\n        this.lastTotalDiscussionCount === 0 ||\r\n        this.isRefreshing\r\n      ) {\r\n        // need to update the discussion list\r\n        this.lastTotalDiscussionCount = this.totalDiscussionCount();\r\n        for (let i = 0; i < this.lastTotalDiscussionCount; i++) {\r\n          this.lastDiscussions[i] = {};\r\n        }\r\n        this.lastLoadedPage = {};\r\n      } else {\r\n        // no need to update the discussion list\r\n        this.lastLoadedPage[pageNum] = page;\r\n        let start = this.options.perPage * (pageNum - 1);\r\n        let end = this.options.perPage * pageNum;\r\n        this.lastDiscussions.splice(start, end - start, ...results);\r\n      }\r\n    }\r\n\r\n    this.getTotalPages = function () {\r\n      return Math.ceil(this.totalDiscussionCount() / this.options.perPage);\r\n    };\r\n\r\n    this.page = Stream(page);\r\n    this.perPage = Stream(this.options.perPage);\r\n    this.totalPages = Stream(this.getTotalPages());\r\n\r\n    this.ctrl = {\r\n      prevPage: function () {\r\n        let current = this.page().number;\r\n        --current;\r\n\r\n        if (current < 1) {\r\n          return;\r\n        }\r\n\r\n        this.page(current);\r\n        let next = current;\r\n        this.loadingPrev = true;\r\n        this.loadPage(next).then((results) => {\r\n          this.parseResults(next, results);\r\n          this.loadingPrev = false;\r\n        });\r\n      }.bind(this),\r\n\r\n      nextPage: function () {\r\n        let current = this.page().number;\r\n        ++current;\r\n\r\n        if (current > this.totalPages()) {\r\n          current = this.totalPages();\r\n          return;\r\n        }\r\n\r\n        this.page(current);\r\n        let next = current;\r\n        this.loadingNext = true;\r\n        this.loadPage(next).then((results) => {\r\n          this.parseResults(next, results);\r\n          this.loadingNext = false;\r\n        });\r\n      }.bind(this),\r\n\r\n      toPage: function (page) {\r\n        if (this.page().number == Number(page) || page < 1 || page > this.totalPages()) return;\r\n\r\n        this.page(Number(page));\r\n        let next = Number(page);\r\n\r\n        this.initialLoading = true;\r\n\r\n        this.loadPage(next).then((results) => {\r\n          this.parseResults(next, results);\r\n          this.initialLoading = false;\r\n        });\r\n      }.bind(this),\r\n\r\n      pageList: function () {\r\n        let p = [],\r\n          left = Math.max(parseInt(this.page().number) - this.options.leftEdges, 1),\r\n          right = Math.min(parseInt(this.page().number) + this.options.rightEdges, this.totalPages());\r\n\r\n        for (let i = left; i <= right; i++) {\r\n          p.push(i);\r\n        }\r\n\r\n        return p;\r\n      }.bind(this),\r\n    };\r\n\r\n    m.redraw();\r\n  });\r\n\r\n  override(DiscussionListState.prototype, 'addDiscussion', function (original, discussion) {\r\n    if (!this.usePaginationMode) {\r\n      return original();\r\n    }\r\n    const index = this.lastDiscussions.indexOf(discussion);\r\n\r\n    if (index !== -1) {\r\n      this.lastDiscussions.splice(index);\r\n      this.lastDiscussions.unshift(discussion);\r\n    } else {\r\n      this.lastDiscussions.unshift(discussion);\r\n      this.lastTotalDiscussionCount++;\r\n      this.totalDiscussionCount(this.lastTotalDiscussionCount);\r\n    }\r\n\r\n    m.redraw();\r\n  });\r\n\r\n  override(DiscussionListState.prototype, 'deleteDiscussion', function (original, discussion) {\r\n    if (!this.usePaginationMode) {\r\n      return original();\r\n    }\r\n    const index = this.lastDiscussions.indexOf(discussion);\r\n\r\n    if (index !== -1) {\r\n      this.lastDiscussions.splice(index);\r\n      this.lastTotalDiscussionCount--;\r\n      this.totalDiscussionCount(this.lastTotalDiscussionCount);\r\n    }\r\n\r\n    m.redraw();\r\n  });\r\n\r\n  override(DiscussionListState.prototype, 'clear', function (original) {\r\n    if (!this.usePaginationMode) {\r\n      return original();\r\n    }\r\n    this.lastDiscussions = [];\r\n    this.lastLoadedPage = {};\r\n    this.lastRquestParams = {};\r\n    this.lastTotalDiscussionCount = 0;\r\n    this.lastTotalPages = 0;\r\n    this.totalDiscussionCount = Stream(0);\r\n    return original();\r\n  });\r\n}\r\n","import app from 'flarum/forum/app';\r\n\r\nexport default function () {\r\n  if (app.session.user === null) {\r\n    return app.forum.attribute('foskym-pagination.paginationOnLoading');\r\n  }\r\n\r\n  const preferences = app.session.user.preferences() as any;\r\n\r\n  if (app.forum.attribute('foskym-pagination.canUserPref')) {\r\n    if (!preferences['foskym-pagination.userCustom']) {\r\n      return app.forum.attribute('foskym-pagination.paginationOnLoading');\r\n    } else {\r\n      if (!preferences['foskym-pagination.userPaginationOnLoading']) {\r\n        return false;\r\n      }\r\n    }\r\n  } else {\r\n    return app.forum.attribute('foskym-pagination.paginationOnLoading');\r\n  }\r\n\r\n  return true;\r\n}\r\n","import app from 'flarum/common/app';\r\nimport { override } from 'flarum/common/extend';\r\nimport DiscussionList from 'flarum/forum/components/DiscussionList';\r\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\r\nimport Placeholder from 'flarum/common/components/Placeholder';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport classList from 'flarum/common/utils/classList';\r\nimport Toolbar from './components/Toolbar';\r\n\r\nexport default function () {\r\n  override(DiscussionList.prototype, 'view', function (original) {\r\n    const state = this.attrs.state;\r\n\r\n    if (!state.usePaginationMode) {\r\n      return original();\r\n    }\r\n\r\n    const params = state.getParams();\r\n    const isLoading = state.isLoading();\r\n\r\n    if (state.isEmpty()) {\r\n      const text = app.translator.trans('core.forum.discussion_list.empty_text');\r\n      return (\r\n        <div className=\"DiscussionList\">\r\n          <Placeholder text={text} />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (isLoading) {\r\n      return (\r\n        <div className={classList('DiscussionList', { 'DiscussionList--searchResults': state.isSearchResults() })}>\r\n          <ul role=\"feed\" aria-busy={isLoading} className=\"DiscussionList-discussions\"></ul>\r\n          <div className=\"DiscussionList-loadMore\">\r\n            <LoadingIndicator />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    const pages = state.getPages();\r\n    let items = [];\r\n\r\n    for (let index = 0; index < pages.length; index++) {\r\n      const page = pages[index];\r\n      if (page.number == state.location.page) {\r\n        items = page.items;\r\n        break;\r\n      }\r\n    }\r\n\r\n    const position = app.forum.attribute('foskym-pagination.paginationPosition');\r\n    const pageSize = state.options.perPage;\r\n    const pageNum = state.page;\r\n\r\n    return (\r\n      <div className={classList('DiscussionList', { 'DiscussionList--searchResults': state.isSearchResults() })}>\r\n        {position == 'above' || position == 'both' ? Toolbar.component({ state }) : ''}\r\n        <ul role=\"feed\" aria-busy={isLoading} className=\"DiscussionList-discussions\">\r\n          {items.map((discussion, itemNum) => (\r\n            <li key={discussion.id()} data-id={discussion.id()} role=\"article\" aria-setsize=\"-1\" aria-posinset={pageNum * pageSize + itemNum}>\r\n              <DiscussionListItem discussion={discussion} params={params} />\r\n            </li>\r\n          ))}\r\n        </ul>\r\n        {position == 'under' || position == 'both' ? Toolbar.component({ state }) : ''}\r\n      </div>\r\n    );\r\n  });\r\n}\r\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_extends","assign","bind","target","i","arguments","length","source","apply","this","_setPrototypeOf","p","setPrototypeOf","__proto__","Toolbar","subClass","superClass","attrs","create","constructor","view","vnode","state","className","class","buttonFirst","buttonBack","ctrl","pageList","map","page","title","number","onclick","toPage","buttonNext","buttonLast","inputJump","buttonJump","Button","icon","disabled","parseInt","totalPages","JumpFunc","input","document","getElementById","Number","isFinite","isSafeInteger","m","id","placeholder","undefined","onkeydown","event","redraw","keyCode","Component","app","extend","SettingsPage","preferences","user","userCustom","Stream","userPaginationOnLoading","items","Boolean","add","FieldSet","label","Pagination_UserPrefItems","toArray","ItemList","Switch","onchange","UserCustom_Loading","savePreferences","then","loading","userPaginationOnLoading_Loading","DiscussionListState","options","cacheDiscussions","perPage","perLoadMore","perIndexInit","leftEdges","rightEdges","usePaginationMode","determineMode","lastTotalDiscussionCount","lastTotalPages","lastDiscussions","lastLoadedPage","lastRquestParams","optionInited","override","original","initOptions","initialLoading","loadingPrev","loadingNext","isRefreshing","clear","location","loadPage","results","pages","parseResults","pageSize","reqParams","requestParams","preloadedDiscussions","totalDiscussionCount","payload","jsonapi","totalResultsCount","Promise","resolve","JSON","stringify","start","end","slice","newOffset","newLimit","include","Array","isArray","join","Math","min","max","params","offset","limit","type","pg","pageNum","links","hasNext","next","hasPrev","prev","hasPage","allPages","getPages","push","splice","getTotalPages","ceil","prevPage","current","nextPage","left","right","discussion","index","indexOf","unshift","DiscussionList","getParams","isLoading","isEmpty","text","classList","isSearchResults","role","position","component","itemNum","DiscussionControls","DiscussionComposer"],"sourceRoot":""}