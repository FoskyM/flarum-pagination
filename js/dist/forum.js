module.exports=function(t){var e={};function a(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=15)}([,function(t,e){t.exports=flarum.core.compat.extend},function(t,e){t.exports=flarum.core.compat["common/components/Button"]},function(t,e){t.exports=flarum.core.compat["common/utils/Stream"]},function(t,e){t.exports=flarum.core.compat["states/DiscussionListState"]},,function(t,e){t.exports=flarum.core.compat["components/DiscussionList"]},function(t,e){t.exports=flarum.core.compat["components/DiscussionListItem"]},function(t,e){t.exports=flarum.core.compat["common/components/LoadingIndicator"]},function(t,e){t.exports=flarum.core.compat["common/components/Placeholder"]},function(t,e){t.exports=flarum.core.compat["components/DiscussionComposer"]},function(t,e){t.exports=flarum.core.compat["utils/DiscussionControls"]},,,,function(t,e,a){"use strict";a.r(e);var n=a(1),o=a(6),i=a.n(o),s=a(4),r=a.n(s),c=a(7),u=a.n(c),p=a(8),l=a.n(p),g=a(9),h=a.n(g),f=a(2),d=a.n(f),P=a(3),b=a.n(P),v=a(10),x=a.n(v),y=a(11),N=a.n(y);app.initializers.add("block-cat/pagination",(function(){Object(n.override)(r.a.prototype,"parseResults",(function(t){var e,a=Number(arguments[1]),n=(null==(e=arguments[2].payload)?void 0:e.links)||{},o={number:a,items:arguments[2],hasNext:!!n.next,hasPrev:!!n.prev};this.hasPage=function(t){var e=this.getPages();if(0==e.length)return!1;for(var a=0;a<e.length;a++)if(e[a].number==t)return!0;return!1},this.hasPage(a)||this.pages.push(o),this.location={page:a},m.redraw()})),Object(n.override)(r.a.prototype,"refresh",(function(t){var e=this;this.initialLoading=!0,this.loadingPrev=!1,this.loadingNext=!1;var a=arguments[1]||1;return this.totalDiscussionCount=b()(app.data.statistics.discussions.total),this.options={perPage:Number(app.forum.attribute("block-cat.articlePerPage")),limit:10,edges:2,ellipsis:"ellip"},this.getTotalPages=function(){return Math.ceil(this.totalDiscussionCount()/this.options.perPage)},this.page=b()(a),this.perPage=b()(this.options.perPage),this.totalPages=b()(this.getTotalPages()),this.ctrl={prevPage:function(){var t=this.page();if(--t<1)t=1;else{this.page(t);var e=t;this.loadPage(e).then(this.parseResults.bind(this,e))}}.bind(this),nextPage:function(){var t=this.page();if(++t>this.totalPages())t=this.totalPages();else{this.page(t);var e=t;this.loadPage(e).then(this.parseResults.bind(this,e))}}.bind(this),toPage:function(t){if(!(this.page()==Number(t)||t<1||t>this.totalPages())){this.page(Number(t));var e=Number(t);this.loadPage(e).then(this.parseResults.bind(this,e))}}.bind(this),pageList:function(){var t=this.requestParams();if("q"in t.filter){for(var e,a,n=t.filter.q.split(":")[1],o=0;o<app.store.all("tags").length;o++)if(app.store.all("tags")[o].slug()===n){e=app.store.all("tags")[o].discussionCount(),a=Math.ceil(e/this.perPage());break}a&&this.totalPages(a)}else this.totalPages(this.getTotalPages());for(var i=[],s=this.totalPages()+1,r=Math.max(parseInt(this.page())-this.options.edges,1),c=Math.min(parseInt(this.page())+this.options.edges,this.totalPages()),u=1;u<s;u++)1===u||u===parseInt(this.totalPages())-1||parseInt(this.totalPages())<this.options.limit?i.push(u):(u!==c+1&&u!==r-1||i.push(this.options.ellipsis),u<=c&&u>=r&&i.push(u));return i}.bind(this),changePerPage:function(t){this.perPage(t),this.totalPages(this.getTotalPages()),this.page(1)}.bind(this)},this.clear(),a=this.page(),this.location={page:a},this.loadPage(a).then((function(t){e.pages=[],e.parseResults(e.location.page,t)})).finally((function(){return e.initialLoading=!1}))})),Object(n.override)(r.a.prototype,"loadPage",(function(t){var e=arguments[1]||1,a=this.requestParams();return a.page={offset:this.options.perPage*(e-1)},Array.isArray(a.include)&&(a.include=a.include.join(",")),app.store.find(this.type,a).then((function(t){return t}))})),Object(n.extend)(i.a.prototype,"view",(function(t){if("none"!=app.forum.attribute("block-cat.paginationPosition")){var e,a=this.attrs.state,n=a.getParams();if(a.isEmpty()){var o=app.translator.trans("core.forum.discussion_list.empty_text");return e=h.a.component({text:o}),t.children=[],void t.children.push(e)}a.isLoading()?e=m("div",{className:"DiscussionList-loadMore"},l.a.component()):function(){for(var t=[],o=a.getPages(),i=0;i<o.length;i++){var s=o[i];if(s.number==a.location.page){s.items.map((function(e){t.push(m("li",{key:e.id(),"data-id":e.id()},u.a.component({discussion:e,params:n})))}));break}}e=m("ul",{className:"DiscussionList-discussions"},t.map((function(t){return t})))}(),t.children=[],t.children.push(e);var i,s,r=d.a.component({title:"Prima",icon:"fa fa-angle-double-left",className:"Button Button--icon",onclick:function(){a.ctrl.toPage(1)}}),c=d.a.component({title:"Înapoi",icon:"fa fa-angle-left",className:"Button Button--icon",onclick:function(){var t=a.page();a.ctrl.toPage(parseInt(t)-1)}}),p=d.a.component({title:"Următoarea",icon:"fa fa-angle-right",className:"Button Button--icon",onclick:function(){var t=a.page();a.ctrl.toPage(parseInt(t)+1)}}),g=d.a.component({title:"Ultima",icon:"fa fa-angle-double-right",className:"Button Button--icon",onclick:function(){var t=parseInt(a.totalPages());a.ctrl.toPage(parseInt(t))}}),f=[];a.ctrl.pageList().map((function(t){var e=this;switch(t){case e.options.ellipsis:f.push(d.a.component({title:"...",icon:"",className:"Button","data-page":"...",style:"cursor:default;"},m("strong",{className:""},"...")));break;default:f.push(d.a.component({title:parseInt(t),icon:"",className:t==e.page()?"Button Button--primary":"Button","data-page":t,onclick:t!=e.page()?function(){e.ctrl.toPage(parseInt(t))}:""},m("strong",{className:""},parseInt(t))))}}),a),i=[r].concat(c,f,p,g),s={view:function(t){return m("div",{id:"toolbar"+Math.floor(10*Math.random()+1),className:"Pagination"},m("ul",{class:"IndexPage-toolbar-view"},t.attrs.groupbuttons.map((function(t){return m("li",{class:""},t)}))))}},"above"==app.forum.attribute("block-cat.paginationPosition")&&!a.isLoading()&&t.children.unshift(m(s,{groupbuttons:i})),"under"==app.forum.attribute("block-cat.paginationPosition")&&!a.isLoading()&&t.children.push(m(s,{groupbuttons:i})),"both"==app.forum.attribute("block-cat.paginationPosition")&&!a.isLoading()&&(t.children.unshift(m(s,{groupbuttons:i}))&&t.children.push(m(s,{groupbuttons:i})))}})),Object(n.extend)(N.a,"deleteAction",(function(){if(app.discussions){var t=app.discussions.location.page;app.discussions.refresh(t)}})),Object(n.extend)(x.a.prototype,"onsubmit",(function(){app.discussions&&app.discussions.refresh()}))}))}]);
//# sourceMappingURL=forum.js.map